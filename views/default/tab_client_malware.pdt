<div class='title_row first'>
    <h3><?php $this->_('CWatch.tab_malware.add_scanner'); ?></h3>
</div>
<div class="row">
    <div class="col-md-12">
        <h4><?php $this->_('CWatch.tab_malware.add_new_site');?></h4>
        <?php
        $this->Form->create($this->base_uri . 'services/manage/' . $this->Html->ifSet($service->id) . '/tabClientMalWare/');
        $this->Form->fieldHidden('actionname', 'addscanner');
        ?>
        <div class="form-group">
            <?php
            $this->Form->label($this->_('CWatch.tab_malware.domainname', true), 'domainname');
            $this->Form->fieldSelect('domainname', $this->Html->ifSet($sites), '', ['class' => 'form-control', 'id' => 'domainname']);
            ?>
        </div>
        <div class="form-group">
            <?php
            $this->Form->label($this->_('CWatch.tab_malware.ftpusername', true), 'ftpusername');
            $this->Form->fieldText('username', '', ['class' => 'form-control', 'id' => 'ftpusername']);
            ?>
        </div>
        <div class="form-group">
            <?php
            $this->Form->label($this->_('CWatch.tab_malware.ftppassword', true), 'ftppassword');
            $this->Form->fieldPassword('password', ['class' => 'form-control', 'id' => 'ftppassword']);
            ?>
        </div>
        <div class="form-group">
            <?php
            $this->Form->label($this->_('CWatch.tab_malware.host', true), 'host');
            $this->Form->fieldText('host', '', ['class' => 'form-control', 'id' => 'host']);
            ?>
        </div>
        <div class="form-group">
            <?php
            $this->Form->label($this->_('CWatch.tab_malware.port', true), 'port');
            $this->Form->fieldText('port', '', ['class' => 'form-control', 'id' => 'port']);
            ?>
        </div>
        <div class="form-group">
            <?php
            $this->Form->label($this->_('CWatch.tab_malware.path', true), 'path');
            $this->Form->fieldText('path', '', ['class' => 'form-control', 'id' => 'path']);
            ?>
        </div>
        <button class="btn btn-default pull-right">
            <i class="fa fa-edit"></i> <?php $this->_('CWatch.tab_malware.submit');?>
        </button>
        <?php
        $this->Form->end();
        ?>
    </div>
    <div class="hide">
        <?php
        foreach ($this->Html->ifSet($domains_ftp, []) as $domain => $domain_ftp) {
        ?>
        <div data-domain="<?php echo $domain;?>" data-login="<?php echo $domain_ftp->login;?>" data-host="<?php echo $domain_ftp->host;?>" data-port="<?php echo $domain_ftp->port;?>" data-path="<?php echo $domain_ftp->path;?>"></div>
        <?php
        }
        ?>
    </div>
</div>
<script>
$(document).on('ready', function() {
    $('#domainname').on('change', function() {
        var ftp = $('div[data-domain="' + $(this).val() + '"]');
        $('#ftpusername').val(ftp.data('login'));
        $('#host').val(ftp.data('host'));
        $('#port').val(ftp.data('port'));
        $('#path').val(ftp.data('path'));
    });
});
</script>
